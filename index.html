<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Local Storage</title>
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
</head>
<body>
  <input type="text" id="newTodo">
  <button id="addBtn">Add</button>
  <ul id="myTodo"></ul>
</body>

<script>
var myTodo = document.getElementById('myTodo')
var newTodo = document.getElementById('newTodo');
var todos = [];

function render(todos){
    var data = todos.map((item, index) => {
        return `<li>${item.content} <button data-id="${index}">Delete</button></li>`
    })
    myTodo.innerHTML = data.join('');
}

//get data
axios.get('http://localhost:3000/todos')
  .then(function (response) {
    // handle success
    var todos = response.data;
    render(todos);
  })
  .catch(function (error) {
    // handle error
    console.log(error);
  })

//Add new todo
newTodo.addEventListener('change', event => {
    axios.post('http://localhost:3000/todos', {
        content: event.target.value
    })
    .then(function (response) {
        console.log(response.data);
    })
    .catch(function (error) {
        console.log(error);
    });
    render(todos);
    event.target.value = '';
})


//Delete
myTodo.addEventListener('click', event => {
    var button = event.target;
    var id = parseInt(button.dataset.id);
    todos.splice(id,1);
    render(todos);
})


</script>
</html>

